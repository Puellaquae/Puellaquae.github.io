<!DOCTYPE html>
<html lang="zh-Hans">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="TODO">
    <title>TODO</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/codecolor.css" />
</head>

<body>
    <header class="header">
        <section sub="" class="navbar-left title">
        </section>
        <section class="navbar-right">
            <a href=".././index.html">首页</a>
            <a href="../page/about.html">关于</a>
            </section>
    </header>
    <div class="container">
        <div class="archive indent">
            <h1>TODO</h1>
            <div class="modified date">
                2022年7月28日
            </div>
            <div class="create date">
                2022年6月27日
            </div>
            
            <div class="entry">
                <h2>使用 LSP 实现泛用的代码语义着色</h2><p>见 <a href="https://github.com/Puellaquae/colorfulize">Puellaquae/colorfulize</a> 项目。</p><p>目前大部分的代码高亮工具都是语法高亮，而支持语义高亮的基本都是代码编辑器或 IDE。所以我希望尝试开发一个基于 LSP 的语义高亮工具，为我的这个网站服务。同时我也希望加入提示功能，像代码编辑器或 IDE 一样，移上去可以显示类型等信息。</p><h2>增量生成功能</h2><p>因为我使用了 pdfLaTex 配合 dvisvgm 来渲染公式，导致一旦文章涉及到公式，就会出现一下两个问题：1、pdfLaTex 编译时间太长，导致一篇文章的编译的耗时达到了分钟级别；2、生成的 svg 图不稳定，每一次渲染出来的字体数据的顺序都是不一致的。所以需要增量编译来解决这两个问题。这就需要实现判断是否需要重新生成的功能了。</p><p>关于增量编译：</p><ul><li>增量编译只应用于宏应用阶段，对于最后文件一概重新生成。</li><li>如果结点源内容改变，需要重新生成</li><li>如果宏输入改变（包括源数据、元数据、宏参数），需要重新生成</li><li>如果宏改变（宏序列化的 SHA256 变化），需要重新生成</li></ul><p>实现：</p><p>假定宏处理为纯函数，缓存宏的输入和输出。使用 <code>Function.toString()</code> 将 Macro 转为文本，使用 SHA256 摘要判断宏是否改变。使用 Node、Macro、MacroCall 的 SHA256 摘要判断宏函数参数是否改变。利用 Proxy 对宏处理过程中读写的元数据进行记录。上述摘要、元数据读取记录、宏输出存入缓存数据。</p><h2>留言功能</h2><p>虽然我这里不会有什么人看，但是我还是希望可以加一个留言功能上去。但是我也希望尽可能不要在我的页面里塞入 JS 脚本，所以我决定以浏览器插件的形式提供留言功能。</p><h2>行内 LaTeX 公式渲染</h2><p>现在已经有了行间的 LaTeX 公式渲染功能，还需要设计行间 LaTeX 公式渲染的功能。</p><p></p>
            </div>
        </div>
    </div>

    <div class="footer">
        <p rel="license"><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0</a></p>
        <p rel="contact">
            <a href="mailto:shentukeqin@hotmail.com">Mail</a>
            <a href="https://github.com/Puellaquae">Github</a>
        </p>
    </div>
</body>

</html>